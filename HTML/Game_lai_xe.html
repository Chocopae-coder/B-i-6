<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Car Obstacle Game with Images</title>
<style>
    body { margin: 0; overflow: hidden; background: #515658; }
    canvas { display: block;width: 600px;height: 700px; margin: auto; background: #e6acac; }
</style>
</head>
<body>
<canvas id="gameCanvas" width="600" height="700"></canvas>
<img id="playerCar" src="E:\Python\B-i-6\HTML\Car2.png" style="display:none;">
<img id="obstacle1" src="E:\Python\B-i-6\HTML\obstacle1.png" style="display:none;">
<img id="obstacle2" src="E:\Python\B-i-6\HTML\obstacle2.png" style="display:none;">
<img id="obstacle3" src="E:\Python\B-i-6\HTML\obstacle3.png" style="display:none;">
<img id="obstacle4" src="E:\Python\B-i-6\HTML\obstacle4.png" style="display:none;">
<img id="obstacle5" src="E:\Python\B-i-6\HTML\obstacle5.png" style="display:none;">
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const car = {
    x: canvas.width/2 - 20,
    y: canvas.height - 100,
    width: 50,
    height: 80,
    speed: 6
};
let obstacles = [];
let score = 0;
let gameOver = false;
let obstacleSpeed = 2;
let spawnInterval = 2000;
let lastSpawn = Date.now();

const keys = {
    ArrowUp: false,
    ArrowDown: false,
    ArrowLeft: false,
    ArrowRight: false
};
const playerCarImage = document.getElementById('playerCar');
const obstacleImages = [
    document.getElementById('obstacle1'),
    document.getElementById('obstacle2'),
    document.getElementById('obstacle3'),
    document.getElementById('obstacle4'),
    document.getElementById('obstacle5')
];
function spawnObstacle() {
    const size = Math.random() * 30 + 50;
    const x = Math.random() * (canvas.width - size);
    const img = obstacleImages[Math.floor(Math.random() * obstacleImages.length)];

    obstacles.push({
        x: x,
        y: -size,
        width: size,
        height: size,
        image: img,
        passed: false
    });
}
// Kiểm tra va chạm
function isColliding(a, b) {
    return !(
        a.x + a.width < b.x ||
        a.x > b.x + b.width ||
        a.y + a.height < b.y ||
        a.y > b.y + b.height
    );
}
// Vẽ xe người chơi
function drawCar() {
    ctx.drawImage(playerCarImage, car.x, car.y, car.width, car.height);
}
// Vẽ chướng ngại vật
function drawObstacles() {
    obstacles.forEach(o => {
        ctx.drawImage(o.image, o.x, o.y, o.width, o.height);
    });
}
// Vẽ điểm số
function drawScore() {
    ctx.fillStyle = 'white';
    ctx.font = '20px Arial';
    ctx.fillText('Score: ' + score, 10, 30);
}
// Cập nhật xe
function updateCar() {
    if (keys.ArrowUp && car.y > 0) car.y -= car.speed;
    if (keys.ArrowDown && car.y + car.height < canvas.height) car.y += car.speed;
    if (keys.ArrowLeft && car.x > 0) car.x -= car.speed;
    if (keys.ArrowRight && car.x + car.width < canvas.width) car.x += car.speed;
}
// Cập nhật chướng ngại vật
function updateObstacles() {
    const now = Date.now();
    if (now - lastSpawn > spawnInterval) {
        spawnObstacle();
        lastSpawn = now;
        obstacleSpeed += 0.4;
        if (spawnInterval > 100) spawnInterval -= 50;
    }

    obstacles.forEach(o => {
        o.y += obstacleSpeed;

        // Tăng điểm nếu xe đi qua
        if (!o.passed && o.y > car.y + car.height) {
            score += 1;
            o.passed = true;
        }

        if (isColliding(car, o)) {
            gameOver = true;
        }
    });

    // Loại bỏ chướng ngại vật ra khỏi canvas
    obstacles = obstacles.filter(o => o.y < canvas.height + 50);
}

// Vòng lặp game
function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (!gameOver) {
        updateCar();
        updateObstacles();
        drawCar();
        drawObstacles();
        drawScore();
        requestAnimationFrame(gameLoop);
    } else {
        ctx.fillStyle = 'white';
        ctx.font = '40px Arial';
        ctx.fillText('Game Over!', canvas.width / 2 - 120, canvas.height / 2);
        ctx.fillText('Score: ' + score, canvas.width / 2 - 80, canvas.height / 2 + 40);
    }
}
document.addEventListener('keydown', e => {
    if (keys.hasOwnProperty(e.key)) keys[e.key] = true;
});
document.addEventListener('keyup', e => {
    if (keys.hasOwnProperty(e.key)) keys[e.key] = false;
});
gameLoop();
</script>
</body>
</html>